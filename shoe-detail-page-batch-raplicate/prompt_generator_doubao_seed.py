import requests
from datetime import datetime

def analysis_product_detail_page(client, image_urls):
    """
    详情页分析
    """
    prompt = """
【专业静物摄影师 + 资深女士鞋类电商运营双视角】
核心目标：基于参考图，仅通过「背景、构图、模特、光影 / 布光」视觉元素，客观精准推导并明确原图对鞋子设计 / 细节的展示逻辑、核心维度与视线落点，逐张独立拆解为一段式精简总结，拆解结果直接落地服务于鞋类电商视觉复刻、详情页 / 主图 / 拍摄的视觉布局。【专业静物摄影师 + 资深女士鞋类电商运营双视角】围绕核心目标拆解，所有描述以原图视觉事实为唯一依据，无主观臆断、无额外演绎、无任何鞋子具体属性描述，覆盖鞋类展示所有场景与实操细节。
⚠️ 核心强制规则（无死角、无模糊）
每张图必含 **【拍摄角度】【摆放角度】** 双标签，角度标注贴合原图视觉 5° 区间即可；【拍摄角度】标清景别 + 视角，【摆放角度】对每只鞋标注「鞋头 / 鞋跟状态 + 朝向 + 水平线夹角」，信息完整即可。
彻底剔除鞋子材质、纹理、工艺、品类、颜色、卖点等所有具体属性描述，仅通过视觉元素推导展示维度，不直接描述鞋本身。
覆盖所有场景：模特上脚 / 手持、纯静物摆放、单 / 多鞋组合、有无模特、特写 / 近景 / 全景 / 局部，多鞋组合需逐只明确展示侧重，不合并、不模糊。
明确鞋体展示遮挡状态：仅标注原图客观存在的遮挡，区分是否遮挡设计细节区（如非设计区轻微遮挡 / 设计区无遮挡），鞋身设计细节区无遮挡为默认要求。
核心结论必双明确：明确展示维度数量（单 / 多维度）+ 具体核心展示维度（1-3 个），结论由视觉元素推导，不凭空判定。
光影 / 构图需精准落地：明确光影对鞋子具体设计的强化作用、构图对视线的精准引导落点，不做笼统描述。
无模特静物场景，重点分析「构图 + 光影 + 背景」的展示协同逻辑；有模特场景，重点分析「模特动态与鞋体的互动展示逻辑」。
📌 核心拆解模块（全链路贴合「视觉展示→鞋子设计」）
鞋体视觉状态：鞋的数量 + 场景状态（模特上脚 / 手持 / 静物摆放）+ 核心姿势 +遮挡状态 + 是否展示鞋底，说明该状态对应的鞋子具体展示部位 / 设计点；多鞋组合逐只标注展示侧重。
双标签核心作用：【拍摄角度】+【摆放角度】，说明该角度对展示鞋子细节的专属优势（如侧拍突出鞋侧轮廓、特写放大局部装饰、微仰展示鞋底形态）。
构图与视线引导：构图方式（对称 / 非对称 / 中心 / 三分法等）+ 留白 / 主体占比，说明构图如何强化核心展示维度 + 精准引导视线落点（如中心构图引导视线聚焦后跟设计、对角线构图引导视线跟随鞋身线条）。
模特 / 肢体互动（有模特时）：模特动态（迈步 / 站立 / 屈膝 / 踮脚等）+ 肢体与鞋的关系，说明该动态展示的鞋子穿着效果 / 设计适配性（如迈步展动态贴合度、站立展脚型适配度、抬手托鞋展整体版型）。
背景 + 布光协同衬托：背景类型（纯色哑光 / 纹理 / 实景等）+ 布光方式（柔光 / 硬光、光源方向）+ 光影细节，说明其如何精准突出核心展示维度（如纯色背景无干扰聚焦局部设计、顶部柔光勾勒鞋身线条、侧光增强鞋身立体感）。
核心展示维度（加粗突出）：综合所有视觉元素，明确单 / 多维度+ 具体维度（限定鞋类专属：鞋侧轮廓 / 后跟设计 / 鞋头形态 / 整体版型 / 鞋身立体感 / 鞋身线条 / 局部装饰 / 鞋底形态 / 上脚贴合度 / 动态穿着感等）。
电商落地可复用价值：标注该视觉搭配方式适配的电商展示场景（详情页首图 / 细节图 / 场景图 / 主图）+同类鞋款适配性（如适配展示有独特后跟 / 流畅线条 / 立体设计的鞋款）+适配的展示需求（单维度细节突出 / 多维度整体展示）。
✍️ 输出硬性要求
纯中文一段式完整总结，【拍摄角度】【摆放角度】双标签前置清晰，核心展示维度加粗突出，所有信息逻辑连贯、一眼可辨。
语言简洁凝练，无冗余修饰、无模糊词汇（大概 / 左右 / 等），所有描述均基于原图视觉事实。
无任何鞋子具体属性描述，仅聚焦「视觉元素作用 + 视线引导 + 核心展示维度 + 电商落地复用」。
信息完整无遗漏，拆解后可直接明确「原图用什么视觉方式→引导视线落向哪里→展示鞋子的单 / 多维度具体设计→适合电商什么场景 / 鞋款复用」。
🚫 绝对禁止项
禁止主观臆断展示维度｜禁止描述鞋子材质 / 品类 / 颜色等具体属性｜禁止合并多鞋组合的展示侧重｜禁止添加 / 删减原图视觉元素｜禁止模糊描述光影 / 构图的具体作用｜禁止笼统标注展示维度（需鞋类专属）｜禁止忽略遮挡状态与鞋底展示｜禁止模糊标注展示维度数量。

"""
    # 构造请求：图片 + 文本提示
    content = []
    for img_url in image_urls:
        content.append({"type": "input_image", "image_url": img_url})
    content.append({"type": "input_text", "text": prompt})

    # 调用豆包视觉模型
    response = client.responses.create(
        model="doubao-seed-1-6-vision-250815",
        input=[{"role": "user", "content": content}]
    )
    # 解析响应
    response_dict = response.model_dump()
    output_text = response_dict["output"][1]["content"][0]["text"]
    return output_text
